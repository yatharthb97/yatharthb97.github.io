<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Langevin Model | Yatharth Bhasin</title>
<meta name="keywords" content="blog">
<meta name="description" content="Blog Post">
<meta name="author" content="Yatharth Bhasin">
<link rel="canonical" href="http://localhost:1313/notes/biophy/langevin-model/">
<meta name="google-site-verification" content="XYZabc">
<meta name="yandex-verification" content="XYZabc">
<meta name="msvalidate.01" content="XYZabc">
<link crossorigin="anonymous" href="/assets/css/stylesheet.296f1c593c14c1225e98bb70764ecc0ba42c9fb87f3b60196d6d71226602183b.css" integrity="sha256-KW8cWTwUwSJemLtwdk7MC6Qsn7h/O2AZbW1xImYCGDs=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/images/website_tile.svg">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="apple-touch-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="mask-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/notes/biophy/langevin-model/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>




<!DOCTYPE html>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css" integrity="sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js" integrity="sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
          ],
          
          throwOnError : true
        });
    });
</script>


<meta property="og:url" content="http://localhost:1313/notes/biophy/langevin-model/">
  <meta property="og:site_name" content="Yatharth Bhasin">
  <meta property="og:title" content="Langevin Model">
  <meta property="og:description" content="Blog Post">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="notes">
    <meta property="article:published_time" content="2022-07-11T15:03:01+05:30">
    <meta property="article:modified_time" content="2022-07-11T15:03:01+05:30">
    <meta property="article:tag" content="Blog">
    <meta property="og:image" content="http://localhost:1313/%3Cimage%20path/url%3E">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/%3Cimage%20path/url%3E">
<meta name="twitter:title" content="Langevin Model">
<meta name="twitter:description" content="Blog Post">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": " ‚úíÔ∏è ",
      "item": "http://localhost:1313/notes/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Biologyüß¨ + Physicsüî≠",
      "item": "http://localhost:1313/notes/biophy/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Langevin Model",
      "item": "http://localhost:1313/notes/biophy/langevin-model/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Langevin Model",
  "name": "Langevin Model",
  "description": "Blog Post",
  "keywords": [
    "blog"
  ],
  "articleBody": "Langevin Model: Theory and Units by Yatharth Bhasin (version 2) This article explains the basic set of equations governing the Langevin model simulation of an FCS process. Further, it includes a thorough discussion on the units conversions needed for the simulation. Implementation is also briefly discussed. The last section details a conversion case study.\nLangevin Equation The Langevin equation simulates Brownian motion of particles. The equation can be solved to simulate non-equilibrium systems.\n{{math}} \\begin{align} m \\frac{dv}{dt} \u0026= - m \\lambda v + F_\\eta(t)\\ m \\frac{dv}{dt} \u0026= - \\gamma v + F_\\eta(t) \\label{main_lang} \\end{align} {{/math}}\nThe mass $m$ is assumed to be absorbed by the constants $\\lambda$ to become $\\gamma$ ‚Üí $m\\lambda = \\gamma$. Please note that $\\gamma$ is not the friction coefficient in conventional sense. It has an absorbed mass factor. We say that it is the damping coefficient.\n$F_\\xi(t)$ is a random force, which is a result of random impacts of implicit fluid particles much smaller than the Brownian particles the equation explicitly describes. In our simulation, we assume that the fluid is implicit. The term $- \\gamma v$ is the Frictional Force (Drag) that the fluid exerts on the particles. The two forces represent the two aspects of interaction of the Brownian and the fluid particles. The first describes fluctuation and the other dissipation. The two forces and this equation is a fundamental description of the atomicity (granularity) of matter. The granularity of matter results in both ‚Äî the fluctuation of thermodynamic quantities and friction. The two forces are thus not independent and are related by a Fluctuation-Dissipation law specific to that system.\nThe force $F_\\xi(t)$ can be either completely random in situations where no other external force is present. In that case, the noise profile is described by a Gaussian White Noise ‚Üí $\\xi(t)$. Which implies that the force at time $t$ is completely uncorrelated with the force at anytime $t^{‚Äô}$ (except $t = t^{‚Äô}$). The noise is described by the equations: $$ \\begin{align} F(t) \u0026= \\xi(t)\\ \\langle \\xi(t) \\rangle \u0026= 0 \\label{gaussn_mean}\\ \\langle \\xi(t_1)\\xi(t_2) \\rangle \u0026= c_0\\delta(t_1 - t_2) \\label{gaussn_corr} \\end{align} $$ The constant $c_0$ can be deduced by the energy balance equations related to the Langevin equations.$\\ref{xxx}$ If a steady component is present, which is usually a result of external forces, the random force takes the form: $$ F_\\xi = F_0 + \\xi(t) \\label{force} $$ In steady state conditions, the average velocity reaches the terminal velocity $v_0$ and the $dv/dt = 0$ condition is satisfied. Substituting these in equation ($\\ref{main_lang}$), we get: $$ v_0 = \\frac{F_0}{\\gamma} \\label{v_0} $$ Mobility($M$) is defined as: $$ M = \\frac{1}{\\gamma} \\label{mobility} $$ For a system with no external forces, and hence $F_0 = 0$, we can conclude using equation ($\\ref{v_0}$) that the terminal velocity is zero. This means that the particles have no preferred direction of movement. If a particle is initialized at the origin, the probability of the particle to be nearest to any side of a cubical box (more appropriate analogy is the diffusion sphere) of appropriate edge after some time $t$ is equal.\nEinstein‚Äôs Fluctuation-Dissipation theorem We state without proof (will be included later): $$ D = \\frac{k_{B}T}{\\gamma}, \\label{diff} $$ this is the Einstein‚Äôs Fluctuation-Dissipation theorem, which is the suitable Fluctuation-Dissipation law for our system. Using equation ($\\ref{mobility}$), in terms of mobility, we get: $$ D = k_{B}T \\cdot M $$\nUpdate Scheme The solution of equation ($\\ref{main_lang}$) yields the update scheme for our simulation: $$ x(t + \\Delta t) = x(t) - {\\frac{1}{\\gamma}\\cdot \\frac{dU}{dx}\\cdot \\Delta t} + \\xi(t) \\label{update_sch_1} $$ The first term on the RHS is the contribution from an external force and is deterministic. This force, if non-zero, gives the particles a directional drift. The equation ($\\ref{gaussn_corr}$) can be expanded and the value $c_0$ is calculated from the energy balance equations(will be included later). The second term $\\xi(t)$ is the random force term, which is characterized by the relation: $$ \u003c\\xi(t)\\cdot \\xi(t^)\u003e = \\frac{2k_BT}{\\gamma} \\cdot \\Delta t \\cdot \\delta_{tt^} $$ This equation clearly defines the dependence of the gaussian noise on the temperature of the system, hence, this noise is an attribute of Thermal Motion present in the system.\nIf we assume that there are no external forces, equation ($\\ref{update_sch_1}$) reduces to: $$ \\begin{align} x(t + \\Delta t) \u0026= x(t) + \\xi(t)\\ \u0026= x(t) + \\sqrt{{2k_BT/\\gamma}\\cdot \\Delta t}\\cdot g(t) \\end{align} $$ $g(t)$ is the pure Gaussian white noise which has a mean of zero and a variance of unity. It is also referred to as the delta-correlated white-noise. By using the Einstein‚Äôs Fluctuation - Dissipation theorem described in equation ($\\ref{diff}$), we get: $$ \\begin{align} \\xi(t) \u0026= \\sqrt{{2k_BT/\\gamma}\\cdot \\Delta t}\\cdot g(t)\\ \u0026= \\sqrt{2 \\cdot D \\cdot \\Delta t} \\cdot g(t) \\end{align} $$\nThis equation describes the movement of particles in terms of its Diffusivity. And based on equation ($\\ref{diff}$), it is coupled to $\\gamma$ , which is coupled to the mass $m$ and the drag coefficient of the fluid ‚Äî $\\lambda$.\nStokes Law We first assume that our particle is spherical. We also assume that the system is in ‚Äúlow Reynolds Number regime‚Äù and other assumptions relevant for the Stokes Model to be applicable. The Stokes law states that: $$ F_{d} = 6 \\pi \\eta R v \\label{stokes_law} $$ Comparing it with the friction term: $$ \\gamma \\cdot v = 6 \\pi \\eta R \\cdot v $$ Hence, $$ \\gamma = 6 \\pi \\eta R \\quad (spheres) \\label{gamma_sph} $$\nFor particles that are not spheres, the $\\gamma$ value can be defined as: $$ \\gamma = \\eta \\space w $$ $w$ represents the size of the particle.[^citation required]\nFor aspherical particles, equation ($\\ref{gamma_sph}$) becomes: $$ \\gamma = 6 \\pi \\eta R_{H} $$ $R_{H}$ is called the Stokes-Einstein radius or the Hydrodynamic radius of the aspherical particle. This parameter not only describes friction in terms of the size, but also takes into account the solvent effects. Hence, $R_{H}$ may depend on ionic configuration, hydrogen bonding, etc.\nUnits The units are set and controlled via a class Units. This class has methods to obtain conversion factors from Real units to Simulation units and vice versa. The Units instance needs to be constructed with a set of basic fundamental units that serve as scales. We choose these fundamental units to be Length, Thermal energy and Viscosity. Alternatively, Length, Temperature and Viscosity, as the conversion between Thermal Energy and Temperature is well defined for constant temperature case.$$\\ref{xxx}$$\nThe scales are usually some fundamental characteristic of the system. Hence, these units also help in forming a more robust interpretation of the data.\nThe rest of the units can be derived using either dimensional analysis or the set of equations that describe the system under investigation. These set of equations are the same that were discussed in the previous section.\nNeed for Simulation Units[^==This section can be skipped==] There are multiple reasons to prefer using Simulation units (also known as reduced units). The reasons broadly consider the accuracy of the computation (minimization of computing errors), and the convenience of using dimensionless entities that don‚Äôt need specific code to track and handle unit conversions. There are also theoretical reason - the Law of Corresponding States$\\ref{xxx}$, but these are less relevant to our case.\nThe use of Simulation units tries to normalizes the numeric domain of all parameters close to unity. Hence, values within a certain domain $$10^{-y} \\leq x \\leq 10^{y}$$ are the most probable, however, if $x$ is outside this range, the chance that an error was committed is high. There is another benefit which helps in the interpretation of data. Since the parameters are normalized, they are easy to plot on isometric graphs which further reduces distortion of presented data. The accuracy of computation is also improved by prevention of denormalized floating point representations in computer memory. This issue is discussed below:\n==My Note: This section needs editing and for all purposes ‚Äî is incomplete.==\nThe parameters in the relations described above are real values ($\\R$), and on a computer, these are represented as floating point numbers. A normalized floating point number can be represented as: $$ Float \\space value = (-1)^S + M \\times 2^{E} $$ $S$ is a 1-bit sign value. $E$ is the exponent and $M$ stands for mantissa which takes a value from 0.100‚Ä¶ to 9.999.. in normalized form (1 significant digit ahead of the decimal point). In normalized-floating-point representation, the ‚Äúfloating point‚Äù is assumed to be at the units place. The value $E$, thus puts strict bounds on largest (or smallest) values that can be represented for a fixed size floating point number.\n‚Äã sizeof(float) = sizeof(1 bit) * (S+E+M)\nBut if a value is given to the float, which is larger or smaller than the set normalized bounds, the float takes a denormalized form (e.g. 001200.000‚Ä¶1 * $10^{max}$). 1 The operation of a normalized float with a denormalized float can lead to undefined behavior. In scientific computing, these cases can be a common occurrence when many complex arithmetic operations are performed(especially subtractive cancellation). It is thus advisable to work with units that are neither too small nor too large.\nSetting Scale The aim of this section is to reduce the dimensionality of the equations describing the system to zero. The most effective way to do this is to select a scale for fundamental units and then divide the equation with a combination of these reduced units that has the same dimensionality as our equation. Hence for each quantity, a scale factor needs to be calculated.\nWe first introduce a notation:\n$y$ ‚Üí real units (SI) $y^*$ ‚Üí simulation units (dimensionless) $y/(scale \\space factor) = y^{}$ and $y^{} \\times scale \\space factor = y$ $Y_{s‚Üír} = scale \\space factor$ : Conversion factor to go from simulation units to real units. $Y_{r‚Üís} = 1/scale \\space factor$ : Conversion factor to go from real units to simulation units. Length and Energy We define a scale for length and energy ‚Üí $\\sigma \\space and \\space \\epsilon$ such that: $$ \\begin{align} \\sigma\u0026= 2R \\quad (diamter) \\space \\label{distance_conv}\\ \\epsilon \u0026= k_{B}T \\quad (thermal \\space energy) \\label{thermal_ene_conv} \\end{align} $$\nThis sets the diameter of the particle in reduced units and the thermal energy of the bath to unity. Note that equation ($\\ref{thermal_ene_conv}$) can be solved with a constant temperature $T$. These equations lead immediately to non-dimensionalization of the potential energy equations and distance equations: $$ \\begin{align} U \u0026= U^{}k_{B}T = U^{}\\epsilon\\ r \u0026= r^{*}\\sigma \\end{align} $$\n‚Äã Special Note: The parameters passed to the simulation objects must be in simulation units only.\nDynamic Viscosity Based on the equations ($\\ref{distance_conv} - \\ref{thermal_ene_conv}$) , the equation ($\\ref{stokes_law}$) in the previous chapter can be written as: $$ \\begin{align} F_d \u0026= 3\\pi \\eta \\sigma v = \\gamma v \\label{stokes}\\ F_d \u0026= \\frac{v}{\\gamma} \\label{Force_Gamma} \\end{align} $$ The ‚Äúgamma factor‚Äù or the damping factor has the dimensions $$[\\gamma] = [\\eta\\sigma] = [ML^{-1}T^{-1}] * [L] = [MT^{-1}]$$. The viscosity scale is usually set to the viscosity of the fluid. Hence, if the solution is composed of water, the viscosity of water in simulation unit assumes the value of unity. For the conversions, we usually use the gamma factor instead of Viscosity.\nUsing equation ($\\ref{stokes}$) we calculate the conversion for Dynamic Viscosity ($\\eta$), $$ \\begin{align} \\eta \u0026= \\frac{\\gamma}{3\\pi \\sigma}\\ \\eta^* \u0026= \\frac{\\eta}{\\Big(\\frac{\\gamma}{\\sigma}\\Big)} = \\frac{1}{3\\pi}\\ \\end{align} $$ Note that $$[\\eta^*] = [1] \\quad$$(dimensionless).\nTime, mass, and force Using these three units (length, energy, and viscosity) as the basis, other units can be derived. By using dimensional analysis, $$ \\begin{align} \\gamma \\quad [=] \\quad [\\eta\\sigma] \\quad \u0026[=] \\quad [M][t]^{-1}\\ k_{B}T \\quad [=] \\quad [\\epsilon] \\quad \u0026[=] \\quad [M][L]^2[t]^{-2}\\ \\sigma \\quad \u0026[=] \\quad [L]\\ \\end{align} $$ We now try to form the basis for some other basic units using dimensional analysis to do basic unit conversions for time, mass, and force. $$ \\begin{align} [t] \u0026= [\\gamma] \\space [k_{B}T]^{-1} \\space [L]^{2}\\ [m] \u0026= [\\gamma]^{2} \\space [k_{B}T]^{-1} \\space [L]^{2}\\ [f] \u0026= [k_{B}T] \\space [L]^{-1}\\ \\end{align} $$\nThe above dimensional equations directly convert to: $$ \\begin{align} t_{real} \u0026= \\frac{\\gamma \\sigma^{2}}{k_{B}T} \\space t_{sim} = T_{s‚Üír} \\space t^{}\\ m_{real} \u0026= \\frac{\\gamma^{2}\\sigma^{2}}{k_{B}T} \\space m_{sim} = M_{s‚Üír} \\space m^{} \\label{mass_conv}\\ f_{real} \u0026= \\frac{k_{B}T}{\\sigma} \\space f_{sim} = F_{s‚Üír} \\space f^{*} \\end{align} $$\nUsing equation ($\\ref{diff}$) and ($\\ref{gamma_sph}$) , the diffusivity conversion can be obtained as: $$ D = \\Big(\\frac{k_{B}T}{\\gamma} \\Big) \\space D^* $$ Using equation ($\\ref{}$) we get the conversion for the diffusion timescale, which is the same as time unit: $$ \\tau = \\Big(\\frac{\\sigma^{2}}{D}\\Big) \\space \\tau^* = \\Big(\\frac{\\gamma \\sigma^{2}}{k_{B}T}\\Big) \\space \\tau^* $$\nAlternate Derivation For equations of time, mass, and force ‚Äî some additional ways of getting the same equations are demonstrated.\nWe choose the time scale $t_{s‚Üír}$ to be of the order of the diffusion timescale as it is a fundamental quantity. Diffusion timescale is defined as the mean time taken by the molecule to diffuse distance that is equal to its diameter. Hence, we define, using equations ($\\ref{diff} \\space, \\ref{distance_conv}, and \\space \\ref{thermal_ene_conv}$) : $$ t_{s‚Üír} = \\frac{\\sigma^{2}}{D} = \\frac{\\sigma^{2}\\gamma}{k_{B}T} = \\frac{\\sigma^{2}\\gamma}{\\epsilon} \\label{time_scale} $$ Note: We ignore the factor of 6 in the denominator as it doesn‚Äôt affect the dimensionality.\nUsing equation ($\\ref{Force_Gamma}$), we have $F = \\gamma v$. Now substituting the scales for velocity $v$, which is $\\sigma/t_{s‚Üír}$ from equation ($\\ref{time_scale}$), we get: $$ F_{s‚Üír} = \\frac{k_{B}T}{\\sigma} = \\frac{\\epsilon}{\\sigma} $$ Now, using Newton‚Äôs second law with our substituted units: $F = ma$: $$ F_{s‚Üír} = M_{s‚Üír} \\times \\frac{\\sigma}{t_{s‚Üír}^2} $$ Solving the above equations for $M_{s‚Üír}$ gives us: $$ M_{s‚Üír} = \\frac{\\sigma^{2} \\gamma^{2}}{k_{B}T} = \\frac{\\sigma^{2} \\gamma^{2}}{\\epsilon} $$ Hence, we recover the same equations that we did from dimensional analysis.\nclass Units : Implementation The instance of the object class Units can be constructed by providing a value for the length, energy, and viscosity ‚Äî our three fundamental units.\nThere are two different set of functions in the class that provide the conversion factors required to convert to and from between simulation and real units. The functions follows this suffix convention:\nUnits::rtos_xxx() ‚Üí provides a conversion factor to convert from real to simulation units. Units::stor_xx() ‚Üí provides a conversion factor to convert from simulation units to real units. Case Study: Units Comparison Test code:\nUnits unit; unit.set_scale_STE(2*1e-9, 300, CONST_WATER_VISCOSITY); std::cout \u003c\u003c unit.profile(1e-3, 1e8) \u003c\u003c std::endl; // (time step, total steps) Output ‚Üí\n‚Ä¢ Sigma(m) : 2.00000e-09 (Set) ‚Ä¢ Temp(K) : 3.00000e+02 (Set) ‚Ä¢ Thermal Energy - kBT(J) : 4.14195e-21 (Set) ‚Ä¢ Viscosity (Pa ‚Ä¢ s): 8.90000e-04 (Set) ‚Ä¢ Gamma : 1.78000e-12\n‚Ä¢ Time(s) : 1.71900e-09 ‚Ä¢ Time Step(s) - 1.00000e-03 : 1.71900e-12 (picoseconds) ‚Ä¢ Total Simulation Time(s) - 1.00000e+08 steps : 1.71900e-01 (0.2 s)\n‚Ä¢ Mass(kg) : 3.05982e-21 ‚Ä¢ Force(N) : 2.07097e-12 ‚Ä¢ Diffusivity D : 2.32694e-09\n$$ \\begin{align} P_{ex} \u0026= S_{p} \\times P_{o-ex} \\times P_{PSF}\\ P_{ex} \u0026= S_{p} \\times \\bar{\\epsilon} \\times P_{PSF}\\ P_{ex} \u0026= S_{p} \\times \\bar{\\epsilon} \\times P_{PSF} \\times P_{laser}\\\n\\end{align} $$\n$$ P_{em} = S_{p} \\times P_{S_{E‚ÜíG}} \\times P_{em} $$\nEventually, the floating-point overflows and the value is set to a fixed overflow(or underflow) representation which is of the type NaN. The operations are highly depended on the machine configuration.¬†‚Ü©Ô∏é\n",
  "wordCount" : "2486",
  "inLanguage": "en",
  "image":"http://localhost:1313/%3Cimage%20path/url%3E","datePublished": "2022-07-11T15:03:01+05:30",
  "dateModified": "2022-07-11T15:03:01+05:30",
  "author":{
    "@type": "Person",
    "name": "Yatharth Bhasin"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/notes/biophy/langevin-model/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Yatharth Bhasin",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/images/website_tile.svg"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Yatharth Bhasin (Alt + H)">
                <img src="http://localhost:1313/images/header_button.gif" alt="" aria-label="logo"
                    height="30">Yatharth Bhasin</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/aboutme/" title="about me">
                    <span>about me</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/projects/" title="projects">
                    <span>projects</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/notes/" title="notes">
                    <span>notes</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/publications/" title="publications">
                    <span>publications</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="search (Alt &#43; /)" accesskey=/>
                    <span>search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/gallery/" title="gallery">
                    <span>gallery</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;¬ª&nbsp;<a href="http://localhost:1313/notes/"> ‚úíÔ∏è </a>&nbsp;¬ª&nbsp;<a href="http://localhost:1313/notes/biophy/">Biologyüß¨ &#43; Physicsüî≠</a></div>
    <h1 class="post-title">
      Langevin Model
    </h1>
    <div class="post-description">
      Blog Post
    </div>
    <div class="post-meta"><span title='2022-07-11 15:03:01 +0530 +0530'>July 11, 2022</span>&nbsp;¬∑&nbsp;12 min&nbsp;¬∑&nbsp;2486 words&nbsp;¬∑&nbsp;Yatharth Bhasin&nbsp;|&nbsp;<a href="https://github.com/yatharthb97/yatharthb97.github.io/tree/main/content//notes/biophy/Langevin%20Model.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#langevin-model-theory-and-units" aria-label="Langevin Model: Theory and Units">Langevin Model: Theory and Units</a></li>
                <li>
                    <a href="#langevin-equation" aria-label="Langevin Equation">Langevin Equation</a><ul>
                        
                <li>
                    <a href="#einsteins-fluctuation-dissipation-theorem" aria-label="Einstein&rsquo;s Fluctuation-Dissipation theorem">Einstein&rsquo;s Fluctuation-Dissipation theorem</a></li>
                <li>
                    <a href="#update-scheme" aria-label="Update Scheme">Update Scheme</a></li>
                <li>
                    <a href="#stokes-law" aria-label="Stokes Law">Stokes Law</a></li></ul>
                </li>
                <li>
                    <a href="#units" aria-label="Units">Units</a><ul>
                        
                <li>
                    <a href="#need-for-simulation-unitsthis-section-can-be-skipped" aria-label="Need for Simulation Units[^==This section can be skipped==]">Need for Simulation Units[^==This section can be skipped==]</a></li>
                <li>
                    <a href="#setting-scale" aria-label="Setting Scale">Setting Scale</a><ul>
                        <ul>
                        
                <li>
                    <a href="#length-and-energy" aria-label="Length and Energy">Length and Energy</a></li>
                <li>
                    <a href="#dynamic-viscosity" aria-label="Dynamic Viscosity">Dynamic Viscosity</a></li>
                <li>
                    <a href="#time-mass-and-force" aria-label="Time, mass, and force">Time, mass, and force</a></li></ul>
                    </ul>
                </li>
                <li>
                    <a href="#alternate-derivation" aria-label="Alternate Derivation">Alternate Derivation</a></li>
                <li>
                    <a href="#class-units--implementation" aria-label="class Units : Implementation">class Units : Implementation</a></li>
                <li>
                    <a href="#case-study-units-comparison" aria-label="Case Study: Units Comparison">Case Study: Units Comparison</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="langevin-model-theory-and-units">Langevin Model: Theory and Units<a hidden class="anchor" aria-hidden="true" href="#langevin-model-theory-and-units">#</a></h1>
<div style = "text-align : center">by Yatharth Bhasin (version 2)</div>
<p>This article explains the basic set of equations governing the Langevin model simulation of an FCS process. Further, it includes a thorough discussion on the units conversions needed for the simulation. Implementation is also briefly discussed. The last section details a conversion case study.</p>
<h1 id="langevin-equation">Langevin Equation<a hidden class="anchor" aria-hidden="true" href="#langevin-equation">#</a></h1>
<p>The Langevin equation simulates Brownian motion of particles. The equation can be solved to simulate non-equilibrium systems.</p>
<p>{{math}}
\begin{align}
m \frac{dv}{dt} &amp;= - m \lambda v + F_\eta(t)\
m \frac{dv}{dt} &amp;= - \gamma v + F_\eta(t) \label{main_lang}
\end{align}
{{/math}}</p>
<p>The mass $m$ is assumed to be absorbed by the constants $\lambda$ to become $\gamma$ ‚Üí $m\lambda = \gamma$. Please note that $\gamma$ is not the friction coefficient in conventional sense. It has an absorbed mass factor. We say that it is the <em>damping coefficient</em>.</p>
<ol>
<li>$F_\xi(t)$ is a random force, which is a result of random impacts of implicit fluid particles much smaller than the Brownian particles the equation explicitly describes. In our simulation, we assume that the fluid is implicit.</li>
<li>The term $- \gamma v$ is the <strong>Frictional Force (Drag)</strong> that the fluid exerts on the particles.</li>
</ol>
<p>The two forces represent the two aspects of interaction of the Brownian and the fluid particles. The first describes <strong>fluctuation</strong> and the other <strong>dissipation</strong>. The two forces and this equation is a fundamental description of the atomicity (granularity) of matter. The granularity of matter results in both ‚Äî the fluctuation of thermodynamic quantities and friction. <u>The two forces are thus not independent and are related by a <strong>Fluctuation-Dissipation</strong> law specific to that system.</u></p>
<p>The force $F_\xi(t)$ can be either completely random in situations where no other external force is present. In that case, the noise profile is described by a Gaussian White Noise ‚Üí $\xi(t)$. Which implies that the force at time $t$ is completely uncorrelated with the force at anytime $t^{&rsquo;}$ (except $t = t^{&rsquo;}$). The noise is described by the equations:
$$
\begin{align}
F(t) &amp;= \xi(t)\
\langle \xi(t) \rangle &amp;= 0 \label{gaussn_mean}\
\langle \xi(t_1)\xi(t_2) \rangle &amp;= c_0\delta(t_1 - t_2) \label{gaussn_corr}
\end{align}
$$
The constant $c_0$ can be deduced by the energy balance equations related to the Langevin equations.$\ref{xxx}$ If a steady component is present, which is usually a result of external forces, the random force takes the form:
$$
F_\xi = F_0 + \xi(t) \label{force}
$$
In steady state conditions, the average velocity reaches the terminal velocity $v_0$ and the $dv/dt = 0$ condition is satisfied. Substituting these in equation ($\ref{main_lang}$), we get:
$$
v_0 = \frac{F_0}{\gamma} \label{v_0}
$$
Mobility($M$) is defined as:
$$
M = \frac{1}{\gamma} \label{mobility}
$$
For a system with no external forces, and hence $F_0 = 0$, we can conclude using equation ($\ref{v_0}$) that the terminal velocity is zero. This means that the particles have no preferred direction of movement. If a particle is initialized at the origin, the probability of the particle to be nearest to any side of a cubical box (more appropriate analogy is the diffusion sphere) of appropriate edge after some time $t$ is equal.</p>
<h2 id="einsteins-fluctuation-dissipation-theorem">Einstein&rsquo;s Fluctuation-Dissipation theorem<a hidden class="anchor" aria-hidden="true" href="#einsteins-fluctuation-dissipation-theorem">#</a></h2>
<p>We state without proof (will be included later):
$$
D = \frac{k_{B}T}{\gamma}, \label{diff}
$$
this is the <strong>Einstein&rsquo;s Fluctuation-Dissipation theorem</strong>, which is the suitable <em>Fluctuation-Dissipation law</em> for our system. Using equation ($\ref{mobility}$), in terms of mobility, we get:
$$
D = k_{B}T \cdot M
$$</p>
<h2 id="update-scheme">Update Scheme<a hidden class="anchor" aria-hidden="true" href="#update-scheme">#</a></h2>
<p>The solution of equation ($\ref{main_lang}$) yields the update scheme for our simulation:
$$
x(t + \Delta t) = x(t) - {\frac{1}{\gamma}\cdot \frac{dU}{dx}\cdot \Delta t} + \xi(t) \label{update_sch_1}
$$
The first term on the RHS is the contribution from an external force and is deterministic. This force, if non-zero, gives the particles a directional drift. The equation ($\ref{gaussn_corr}$) can be expanded and the value $c_0$ is calculated from the energy balance equations(will be included later). The second term $\xi(t)$ is the random force term, which is characterized by the relation:
$$
&lt;\xi(t)\cdot \xi(t^<code>)&gt; = \frac{2k_BT}{\gamma} \cdot \Delta t \cdot \delta_{tt^</code>}
$$
This equation clearly defines the dependence of the gaussian noise on the temperature of the system, hence, this noise is an attribute of <strong>Thermal Motion</strong> present in the system.</p>
<p>If we assume that there are no external forces, equation ($\ref{update_sch_1}$) reduces to:
$$
\begin{align}
x(t + \Delta t)
&amp;= x(t) + \xi(t)\
&amp;= x(t) + \sqrt{{2k_BT/\gamma}\cdot \Delta t}\cdot g(t)
\end{align}
$$
$g(t)$ is the pure Gaussian white noise which has a mean of zero and a variance of unity. It is also referred to as the delta-correlated white-noise. By using the Einstein&rsquo;s Fluctuation - Dissipation theorem described in equation ($\ref{diff}$), we get:
$$
\begin{align}
\xi(t)
&amp;= \sqrt{{2k_BT/\gamma}\cdot \Delta t}\cdot g(t)\
&amp;= \sqrt{2 \cdot D \cdot \Delta t} \cdot g(t)
\end{align}
$$</p>
<p>This equation describes the movement of particles in terms of its <em>Diffusivity</em>. <strong>And based on equation ($\ref{diff}$), it is coupled to $\gamma$ , which is coupled to the mass $m$ and the drag coefficient of the fluid ‚Äî $\lambda$.</strong></p>
<h2 id="stokes-law">Stokes Law<a hidden class="anchor" aria-hidden="true" href="#stokes-law">#</a></h2>
<p>We first assume that our particle is spherical. We also assume that the system is in &ldquo;low Reynolds Number regime&rdquo; and other assumptions relevant for the <em>Stokes Model</em> to be applicable.  The Stokes law states that:
$$
F_{d} = 6 \pi \eta R v \label{stokes_law}
$$
Comparing it with the friction term:
$$
\gamma \cdot v = 6 \pi \eta R \cdot v
$$
Hence,
$$
\gamma = 6 \pi \eta R \quad (spheres) \label{gamma_sph}
$$</p>
<p>For particles that are not spheres, the $\gamma$ value can be defined as:
$$
\gamma = \eta \space w
$$
$w$ represents the size of the particle.[^citation required]</p>
<p>For aspherical particles, equation ($\ref{gamma_sph}$) becomes:
$$
\gamma = 6 \pi \eta R_{H}
$$
$R_{H}$ is called the <strong>Stokes-Einstein radius</strong> or the <strong>Hydrodynamic radius</strong> of the aspherical particle. This parameter not only describes friction in terms of the size, but also takes into account the solvent effects. Hence, $R_{H}$ may depend on ionic configuration, hydrogen bonding, etc.</p>
<h1 id="units">Units<a hidden class="anchor" aria-hidden="true" href="#units">#</a></h1>
<p>The units are set and controlled via a <code>class Units</code>. This class has methods to obtain conversion factors from <em>Real units to Simulation units</em> and vice versa. The <code>Units</code> instance needs to be constructed with a set of basic fundamental units that serve as <em>scales</em>. We choose these fundamental units to be <em>Length, Thermal energy and Viscosity.</em> Alternatively, <em>Length, Temperature and Viscosity</em>, as the conversion between Thermal Energy and Temperature is well defined for constant temperature case.$$\ref{xxx}$$</p>
<p>The  <em>scales</em> are usually some fundamental characteristic of the system. Hence, these units also help in forming a more robust interpretation of the data.</p>
<p>The rest of the units can be derived using either dimensional analysis or the set of equations that describe the system under investigation. These set of equations are the same that were discussed in the previous section.</p>
<h2 id="need-for-simulation-unitsthis-section-can-be-skipped">Need for Simulation Units[^==This section can be skipped==]<a hidden class="anchor" aria-hidden="true" href="#need-for-simulation-unitsthis-section-can-be-skipped">#</a></h2>
<p>There are multiple reasons to prefer using <em>Simulation units (also known as reduced units)</em>. The reasons broadly consider the accuracy of the computation (minimization of computing errors), and the convenience of using dimensionless entities that don&rsquo;t need specific code to track and handle unit conversions. There are also theoretical reason - the <em>Law of Corresponding States</em>$\ref{xxx}$, but these are less relevant to our case.</p>
<p>The use of Simulation units <em>tries</em> to normalizes the numeric domain of all parameters close to unity. Hence, values within a certain domain $$10^{-y} \leq x \leq 10^{y}$$ are the most probable, however, if $x$ is outside this range, the chance that an error was committed is high. There is another benefit which helps in the interpretation of data. Since the parameters are normalized, they are easy to plot on isometric graphs which further reduces distortion of presented data. The accuracy of computation is also improved by prevention of <em>denormalized floating point representations in computer memory</em>. This issue is discussed below:</p>
<blockquote>
<p>==My Note: This section needs editing and for all purposes ‚Äî  is incomplete.==</p>
<p>The parameters in the relations described above are real values ($\R$), and on a computer, these are represented as floating point numbers. A <em>normalized</em> floating point number can be represented as:
$$
Float \space value = (-1)^S + M \times 2^{E}
$$
$S$ is a 1-bit sign value. $E$ is the exponent and $M$ stands for mantissa which takes a value from 0.100&hellip; to 9.999.. in <strong>normalized form (1 significant digit ahead of the decimal point)</strong>. In normalized-floating-point representation, the &ldquo;floating point&rdquo; is assumed to be at the units place. The value $E$, thus puts strict bounds on largest (or smallest) values that can be represented for a fixed size floating  point number.</p>
<p>‚Äã <code>sizeof(float) = sizeof(1 bit) * (S+E+M)</code></p>
<p>But if a value is given to the float, which is larger or smaller than the set normalized bounds, the float takes a <em>denormalized</em> form (e.g. 001200.000&hellip;1 * $10^{max}$). <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> The operation of a normalized float with a denormalized float can lead to undefined behavior. In scientific computing, these cases can be a common occurrence when many complex arithmetic operations are performed(especially subtractive cancellation). It is thus advisable to work with units that are neither too small nor too large.</p></blockquote>
<h2 id="setting-scale">Setting Scale<a hidden class="anchor" aria-hidden="true" href="#setting-scale">#</a></h2>
<p>The aim of this section is to reduce the <em>dimensionality</em> of the equations describing the system to zero. The most effective way to do this is to select a scale for fundamental units and then divide the equation with a combination of these reduced units that has the same dimensionality as our equation. Hence for each quantity, a scale factor needs to be calculated.</p>
<p>We first introduce a notation:</p>
<ul>
<li>$y$   ‚Üí  real units (SI)</li>
<li>$y^*$  ‚Üí simulation units (dimensionless)</li>
<li>$y/(scale \space factor) = y^{<em>}$ and $y^{</em>} \times scale \space factor = y$</li>
<li>$Y_{s‚Üír} = scale \space factor$ : Conversion factor to go from simulation units to real units.</li>
<li>$Y_{r‚Üís} = 1/scale \space factor$ : Conversion factor to go from real units to simulation units.</li>
</ul>
<h4 id="length-and-energy">Length and Energy<a hidden class="anchor" aria-hidden="true" href="#length-and-energy">#</a></h4>
<p>We define a scale for <em>length and  energy  ‚Üí  $\sigma \space and \space \epsilon$</em> such that:
$$
\begin{align}
\sigma&amp;= 2R \quad (diamter) \space \label{distance_conv}\
\epsilon &amp;= k_{B}T \quad (thermal \space energy) \label{thermal_ene_conv}
\end{align}
$$</p>
<p>This sets the diameter of the particle in reduced units and the thermal energy of the bath to unity. Note that equation ($\ref{thermal_ene_conv}$) can be solved with a constant temperature $T$. These equations lead immediately to non-dimensionalization of the potential energy equations and distance equations:
$$
\begin{align}
U &amp;= U^{<em>}k_{B}T = U^{</em>}\epsilon\
r &amp;= r^{*}\sigma
\end{align}
$$</p>
<blockquote>
<p>‚Äã Special Note: The parameters passed to the simulation objects must be in simulation units only.</p></blockquote>
<h4 id="dynamic-viscosity">Dynamic Viscosity<a hidden class="anchor" aria-hidden="true" href="#dynamic-viscosity">#</a></h4>
<p>Based on the equations ($\ref{distance_conv} - \ref{thermal_ene_conv}$) , the equation ($\ref{stokes_law}$) in the previous chapter can be written as:
$$
\begin{align}
F_d &amp;= 3\pi \eta \sigma v = \gamma v \label{stokes}\
F_d &amp;= \frac{v}{\gamma} \label{Force_Gamma}
\end{align}
$$
The <em>&ldquo;gamma factor&rdquo;</em> or the <em>damping factor</em> has the dimensions $$[\gamma] = [\eta\sigma] = [ML^{-1}T^{-1}] * [L] = [MT^{-1}]$$. <u>The viscosity scale is usually set to the viscosity of the fluid.</u> Hence, if the solution is composed of water, the viscosity of water in simulation unit assumes the value of unity. For the conversions, we usually use the gamma factor instead of Viscosity.</p>
<p>Using equation ($\ref{stokes}$) we calculate the conversion for <em>Dynamic Viscosity</em> ($\eta$),
$$
\begin{align}
\eta &amp;= \frac{\gamma}{3\pi \sigma}\
\eta^* &amp;= \frac{\eta}{\Big(\frac{\gamma}{\sigma}\Big)} = \frac{1}{3\pi}\
\end{align}
$$
Note that $$[\eta^*] = [1] \quad$$(dimensionless).</p>
<h4 id="time-mass-and-force">Time, mass, and force<a hidden class="anchor" aria-hidden="true" href="#time-mass-and-force">#</a></h4>
<p>Using these three units <em>(length, energy, and viscosity)</em> as the basis, other units can be derived. By using dimensional analysis,
$$
\begin{align}
\gamma \quad [=]  \quad [\eta\sigma] \quad &amp;[=] \quad [M][t]^{-1}\
k_{B}T \quad [=] \quad [\epsilon] \quad &amp;[=] \quad [M][L]^2[t]^{-2}\
\sigma \quad &amp;[=] \quad [L]\
\end{align}
$$
We now try to form the basis for some other basic units using dimensional analysis to do basic unit conversions for time, mass, and force.
$$
\begin{align}
[t] &amp;= [\gamma] \space [k_{B}T]^{-1} \space [L]^{2}\
[m] &amp;= [\gamma]^{2} \space [k_{B}T]^{-1} \space [L]^{2}\
[f] &amp;= [k_{B}T] \space [L]^{-1}\
\end{align}
$$</p>
<p>The above dimensional equations directly convert to:
$$
\begin{align}
t_{real} &amp;= \frac{\gamma \sigma^{2}}{k_{B}T} \space t_{sim}  = T_{s‚Üír} \space t^{<em>}\
m_{real} &amp;= \frac{\gamma^{2}\sigma^{2}}{k_{B}T} \space m_{sim}   = M_{s‚Üír} \space m^{</em>} \label{mass_conv}\
f_{real} &amp;= \frac{k_{B}T}{\sigma} \space f_{sim}   = F_{s‚Üír} \space f^{*}
\end{align}
$$</p>
<p>Using equation ($\ref{diff}$) and ($\ref{gamma_sph}$) , the diffusivity conversion can be obtained as:
$$
D = \Big(\frac{k_{B}T}{\gamma} \Big) \space D^*
$$
Using equation ($\ref{}$) we get the conversion for the diffusion timescale, which is the same as time unit:
$$
\tau = \Big(\frac{\sigma^{2}}{D}\Big) \space \tau^* = \Big(\frac{\gamma \sigma^{2}}{k_{B}T}\Big) \space \tau^*
$$</p>
<h2 id="alternate-derivation">Alternate Derivation<a hidden class="anchor" aria-hidden="true" href="#alternate-derivation">#</a></h2>
<p>For equations of time, mass, and force ‚Äî some additional ways of getting the same equations are demonstrated.</p>
<p>We choose the time scale $t_{s‚Üír}$ to be of the order of the <em>diffusion timescale</em> as it is a fundamental quantity. Diffusion timescale is defined as the mean time taken by the molecule to diffuse distance that is equal to its diameter. Hence, we define, using equations ($\ref{diff} \space, \ref{distance_conv}, and  \space \ref{thermal_ene_conv}$) :
$$
t_{s‚Üír} = \frac{\sigma^{2}}{D} =  \frac{\sigma^{2}\gamma}{k_{B}T} =  \frac{\sigma^{2}\gamma}{\epsilon} \label{time_scale}
$$
Note: We ignore the factor of 6 in the denominator as it doesn&rsquo;t affect the dimensionality.</p>
<p>Using equation ($\ref{Force_Gamma}$), we have $F = \gamma v$. Now substituting the scales for velocity $v$, which is $\sigma/t_{s‚Üír}$ from equation ($\ref{time_scale}$), we get:
$$
F_{s‚Üír} = \frac{k_{B}T}{\sigma} = \frac{\epsilon}{\sigma}
$$
Now, using Newton&rsquo;s second law with our substituted units: $F = ma$:
$$
F_{s‚Üír} = M_{s‚Üír} \times \frac{\sigma}{t_{s‚Üír}^2}
$$
Solving the above equations for $M_{s‚Üír}$ gives us:
$$
M_{s‚Üír} = \frac{\sigma^{2} \gamma^{2}}{k_{B}T} = \frac{\sigma^{2} \gamma^{2}}{\epsilon}
$$
Hence, we recover the same equations that we did from dimensional analysis.</p>
<h2 id="class-units--implementation"><code>class Units</code> : Implementation<a hidden class="anchor" aria-hidden="true" href="#class-units--implementation">#</a></h2>
<p>The instance of the object <code>class Units</code> can be constructed by providing a value for the length, energy, and viscosity ‚Äî our three fundamental units.</p>
<p>There are two different set of functions in the class that provide the conversion factors required to convert to and from between simulation and real units. The functions follows this suffix convention:</p>
<ul>
<li><code>Units::rtos_xxx()</code>  ‚Üí provides a conversion factor to convert <em>from real to simulation units.</em></li>
<li><code>Units::stor_xx()</code> ‚Üí provides a conversion factor to convert from <em>simulation units to real units.</em></li>
</ul>
<h2 id="case-study-units-comparison">Case Study: Units Comparison<a hidden class="anchor" aria-hidden="true" href="#case-study-units-comparison">#</a></h2>
<p>Test code:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">    <span class="n">Units</span> <span class="n">unit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">unit</span><span class="p">.</span><span class="n">set_scale_STE</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mf">1e-9</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="n">CONST_WATER_VISCOSITY</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">unit</span><span class="p">.</span><span class="n">profile</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e8</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                 <span class="c1">// (time step, total steps)
</span></span></span></code></pre></div><p>Output ‚Üí</p>
<p>‚Ä¢ Sigma(m) : 2.00000e-09 (Set)
‚Ä¢ Temp(K) : 3.00000e+02 (Set)
‚Ä¢ Thermal Energy - kBT(J) : 4.14195e-21 (Set)
‚Ä¢ Viscosity (Pa ‚Ä¢ s): 8.90000e-04 (Set)
‚Ä¢ Gamma : 1.78000e-12</p>
<p>‚Ä¢ Time(s) : 1.71900e-09
‚Ä¢ Time Step(s) - 1.00000e-03 : 1.71900e-12 (picoseconds)
‚Ä¢ Total Simulation Time(s) - 1.00000e+08 steps : 1.71900e-01 (0.2 s)</p>
<p>‚Ä¢ Mass(kg) : 3.05982e-21
‚Ä¢ Force(N) : 2.07097e-12
‚Ä¢ Diffusivity D : 2.32694e-09</p>
<p>$$
\begin{align}
P_{ex} &amp;= S_{p} \times P_{o-ex} \times P_{PSF}\
P_{ex} &amp;= S_{p} \times \bar{\epsilon} \times P_{PSF}\
P_{ex} &amp;= S_{p} \times \bar{\epsilon} \times P_{PSF} \times P_{laser}\</p>
<p>\end{align}
$$</p>
<p>$$
P_{em} = S_{p} \times P_{S_{E‚ÜíG}} \times P_{em}
$$</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Eventually, the floating-point overflows and the value is set to a fixed overflow(or underflow) representation which is of the type <code>NaN</code>. The operations are highly depended on the machine configuration.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>


  </div>

  

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/blog/">Blog</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/projects/correlator-card-notes/">
    <span class="title">¬´ Prev</span>
    <br>
    <span>Correlator Card Notes</span>
  </a>
  <a class="next" href="http://localhost:1313/projects/python-time-literals/">
    <span class="title">Next ¬ª</span>
    <br>
    <span>Python Time Literals</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">Yatharth Bhasin</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
